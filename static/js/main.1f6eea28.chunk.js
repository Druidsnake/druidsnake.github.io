(this.webpackJsonpcalendar=this.webpackJsonpcalendar||[]).push([[0],{123:function(e,t,n){},125:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(8),c=n.n(r),o=n(9),s=n(26),i=n(5),u={uiOpenModal:"[ui] Open modal",uiCloseModal:"[ui] Close modal",calendarSetActiveEvent:"[calendar] Set active event",calendarAddNewEvent:"[calendar] Add new event",calendarClearActiveEvent:"[calendar] Clear Active event",calendarStartUpdating:"[calendar] Event start to update",calendarUpdatedEvent:"[calendar] Event updated",calendarDeletedEvent:"[calendar] Event deleted",calendarStartLoading:"[calendar] Events start loading",calendarLoaded:"[calendar] Events loaded",calendarLogoutEvent:"[auth] Cleaning events data",authCheckingFinish:"[auth] Finish checking login state",authStartLogin:"[auth] Start login",authLogin:"[auth] Login",authStartRegister:"[auth] Start register",authStartTokenRenew:"[auth] Start token renew",authLogout:"[auth] Logout"},l={checking:!0,uid:null,name:null},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.authLogin:return Object(i.a)(Object(i.a)(Object(i.a)({},e),t.payload),{},{checking:!1});case u.authLogout:case u.authClearSessionData:return{checking:!1};case u.authCheckingFinish:return Object(i.a)(Object(i.a)({},e),{},{checking:!1});default:return e}},j=n(51),b=n(11),p=n.n(b),m=n(18),v=n(13),f=n.n(v),O="https://calendar-express.herokuapp.com/api",h=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var a,r,c=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=c.length>2&&void 0!==c[2]?c[2]:"GET",r="".concat(O,"/").concat(t),"GET"!==a){e.next=8;break}return e.next=5,fetch(r);case 5:return e.abrupt("return",e.sent);case 8:return e.next=10,fetch(r,{method:a,headers:{"Content-type":"application/json"},body:JSON.stringify(n)});case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var a,r,c,o=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.length>2&&void 0!==o[2]?o[2]:"GET",r="".concat(O,"/").concat(t),c=localStorage.getItem("token"),"GET"!==a){e.next=9;break}return e.next=6,fetch(r,{method:a,headers:{"x-token":c}});case 6:return e.abrupt("return",e.sent);case 9:return e.next=11,fetch(r,{method:a,headers:{"Content-type":"application/json","x-token":c},body:JSON.stringify(n)});case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=n(19),y=n.n(x),E=function(e){return{type:u.calendarAddNewEvent,payload:e}},k=function(e){return{type:u.calendarClearActiveEvent}},w=function(e){return{type:u.calendarUpdatedEvent,payload:e}},N=function(e){return{type:u.calendarLoaded,payload:e}},S={events:[],activeEvent:null},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.calendarLoaded:return Object(i.a)(Object(i.a)({},e),{},{events:Object(j.a)(t.payload)});case u.calendarSetActiveEvent:return Object(i.a)(Object(i.a)({},e),{},{activeEvent:t.payload});case u.calendarAddNewEvent:return Object(i.a)(Object(i.a)({},e),{},{events:[].concat(Object(j.a)(e.events),[t.payload])});case u.calendarClearActiveEvent:return Object(i.a)(Object(i.a)({},e),{},{activeEvent:null});case u.calendarUpdatedEvent:return Object(i.a)(Object(i.a)({},e),{},{events:e.events.map((function(e){return e.id===t.payload.id?t.payload:e}))});case u.calendarDeletedEvent:return Object(i.a)(Object(i.a)({},e),{},{events:e.events.filter((function(e){return e.id!==t.payload.id}))});case u.calendarLogoutEvent:return Object(i.a)({},S);default:return e}},_={modalOpen:!1},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.uiOpenModal:return Object(i.a)(Object(i.a)({},e),{},{modalOpen:!0});case u.uiCloseModal:return Object(i.a)(Object(i.a)({},e),{},{modalOpen:!1});default:return e}},A=Object(s.b)({ui:D,auth:d,calendar:C}),L=n(63),T="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.c,I=Object(s.d)(A,T(Object(s.a)(L.a))),M=n(33),F=n(10),R=n(17),U=n(25),G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(a.useState)(e),n=Object(R.a)(t,2),r=n[0],c=n[1],o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;c(t)},s=function(e){var t=e.target;c(Object(i.a)(Object(i.a)({},r),{},Object(U.a)({},t.name,t.value)))};return[r,s,o]},P=function(e){return{type:u.authLogin,payload:e}},V=function(){return function(e){localStorage.clear(),e({type:u.authLogout}),e({type:u.calendarLogoutEvent})}},H=function(){return{type:u.authCheckingFinish}},J=(n(88),n(2)),B=function(){var e=Object(o.b)(),t=G({login_email:"drullian@gmail.com",login_password:"casacasa"}),n=Object(R.a)(t,3),a=n[0],r=n[1],c=(n[2],G({register_name:"Druidsnake",register_mail:"drullian@gmail.com",register_password:"casacasa",register_password2:"casacasa"})),s=Object(R.a)(c,3),i=s[0],u=s[1],l=(s[2],a.login_email),d=a.login_password,j=i.register_name,b=i.register_mail,v=i.register_password,O=i.register_password2;return Object(J.jsx)("div",{className:"container login-container",children:Object(J.jsxs)("div",{className:"row",children:[Object(J.jsxs)("div",{className:"col-md-6 login-form-1",children:[Object(J.jsx)("h3",{children:"Ingreso"}),Object(J.jsxs)("form",{onSubmit:function(t){var n,a;t.preventDefault(),e((n=l,a=d,function(){var e=Object(m.a)(p.a.mark((function e(t){var r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("auth",{email:n,password:a},"POST");case 2:return r=e.sent,e.next=5,r.json();case 5:(c=e.sent).ok?(localStorage.setItem("token",c.token),localStorage.setItem("token-init-date",(new Date).getTime()),t(P({uid:c.uid,name:c.name}))):f.a.fire("Error",c.msg,"error");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))},children:[Object(J.jsx)("div",{className:"form-group",children:Object(J.jsx)("input",{name:"login_email",type:"text",value:l,className:"form-control",placeholder:"Correo",onChange:r})}),Object(J.jsx)("div",{className:"form-group",children:Object(J.jsx)("input",{name:"login_password",type:"password",value:d,className:"form-control",placeholder:"Contrase\xf1a",onChange:r})}),Object(J.jsx)("div",{className:"form-group",children:Object(J.jsx)("input",{type:"submit",className:"btnSubmit",value:"Login"})})]})]}),Object(J.jsxs)("div",{className:"col-md-6 login-form-2",children:[Object(J.jsx)("h3",{children:"Registro"}),Object(J.jsxs)("form",{onSubmit:function(t){if(t.preventDefault(),v!==O)return f.a.fire("Error","Las contrase\xf1as deben ser iguales","error");var n,a,r;e((n=j,a=b,r=v,function(){var e=Object(m.a)(p.a.mark((function e(t){var c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("auth/new",{name:n,email:a,password:r},"POST");case 2:return c=e.sent,e.next=5,c.json();case 5:if(!(o=e.sent).ok){e.next=12;break}localStorage.setItem("token",o.token),localStorage.setItem("token-init-date",(new Date).getTime()),t(P({uid:o.uid,name:o.name})),e.next=13;break;case 12:return e.abrupt("return",f.a.fire("Error",o.msg,"error"));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))},children:[Object(J.jsx)("div",{className:"form-group",children:Object(J.jsx)("input",{name:"register_name",type:"text",value:j,className:"form-control",placeholder:"Nombre",onChange:u})}),Object(J.jsx)("div",{className:"form-group",children:Object(J.jsx)("input",{name:"register_mail",type:"email",value:b,className:"form-control",placeholder:"Correo",onChange:u})}),Object(J.jsx)("div",{className:"form-group",children:Object(J.jsx)("input",{name:"register_password",type:"password",value:v,className:"form-control",placeholder:"Contrase\xf1a",onChange:u})}),Object(J.jsx)("div",{className:"form-group",children:Object(J.jsx)("input",{name:"register_password2",type:"password",value:O,className:"form-control",placeholder:"Repita la contrase\xf1a",onChange:u})}),Object(J.jsx)("div",{className:"form-group",children:Object(J.jsx)("input",{type:"submit",className:"btnSubmit",value:"Crear cuenta"})})]})]})]})})},X=n(50),q=(n(90),n(91),function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth})).name;return Object(J.jsxs)("div",{className:"navbar navbar-dark bg-dark mb-4",children:[Object(J.jsx)("span",{className:"navbar-brand",children:t}),Object(J.jsxs)("button",{className:"btn btn-outline-danger",onClick:function(){e(V())},children:[Object(J.jsx)("i",{className:"fas fa-sign-out-alt mr-2"}),Object(J.jsx)("span",{children:"Salir"})]})]})}),z={allDay:"Todo el d\xeda",previous:"<",next:">",today:"Hoy",month:"Mes",week:"Semana",day:"D\xeda",agenda:"Agenda",date:"Fecha",time:"Hora",event:"Evento",noEventsInRange:"No hay eventos en este rango",showMore:function(e){return"+ Ver m\xe1s (".concat(e,")")}},K=function(e){var t=e.event,n=t.title,a=t.user;return Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)("strong",{children:n}),Object(J.jsxs)("span",{children:[" - ",a.name]})]})},Q=n(46),W=n.n(Q),Y=n(47),Z=n.n(Y),$=function(){return{type:u.uiOpenModal}},ee=y()().minutes(0).seconds(0),te=ee.clone().add(1,"hours"),ne={title:"",notes:"",start:ee.toDate(),end:ee.add(1,"hour").toDate()},ae=function(){var e=Object(o.b)(),t=Object(a.useState)(ee.toDate()),n=Object(R.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(te.toDate()),l=Object(R.a)(s,2),d=l[0],j=l[1],b=Object(a.useState)(!0),v=Object(R.a)(b,2),O=v[0],h=v[1],x=Object(o.c)((function(e){return e.ui})).modalOpen,N=Object(a.useState)(ne),S=Object(R.a)(N,2),C=S[0],_=S[1],D=C.notes,A=C.title,L=C.start,T=C.end,I=Object(o.c)((function(e){return e.calendar})).activeEvent,M=Object(o.c)((function(e){return e.auth}));M.uid,M.name;Object(a.useEffect)((function(){_(I?Object(i.a)({},I):ne)}),[I]);W.a.setAppElement("#root");var F=function(t){e({type:u.uiCloseModal}),e(k()),_(ne)},G=function(e){var t=e.target;_(Object(i.a)(Object(i.a)({},C),{},Object(U.a)({},t.name,t.value)))};return Object(J.jsx)("div",{children:Object(J.jsxs)(W.a,{isOpen:x,onAfterOpen:function(){},onRequestClose:F,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},closeTimeoutMS:200,className:"modal",overlayClassName:"modal-fondo",contentLabel:"Example Modal",children:[Object(J.jsx)("h1",{children:" Nuevo evento "}),Object(J.jsx)("hr",{}),Object(J.jsxs)("form",{noValidate:!0,onSubmit:function(t){t.preventDefault(),console.log(L),console.log(T);var n=y()(L),a=y()(T);return n.isSameOrAfter(a)?f.a.fire("Error","La fecha fin debe ser mayor a la fecha inicio","error"):A.trim().length<2?h(!1):(h(!0),e(I?function(e){return function(){var t=Object(m.a)(p.a.mark((function t(n,a){var r,c,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a().calendar.activeEvent,t.prev=1,t.next=4,g("events/".concat(r.id),Object(i.a)(Object(i.a)({},r),e),"PUT");case 4:return c=t.sent,t.next=7,c.json();case 7:(o=t.sent).ok?n(w(e)):f.a.fire("Error",o.msg,"error"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,n){return t.apply(this,arguments)}}()}(C):function(e){return function(){var t=Object(m.a)(p.a.mark((function t(n,a){var r,c,o,s,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a().auth,c=r.uid,o=r.name,t.prev=1,t.next=4,g("events",e,"POST");case 4:return s=t.sent,t.next=7,s.json();case 7:(i=t.sent).ok?(e.id=i.eventId,e.user={_id:c,name:o},n(E(e)),f.a.fire("Success","Evento creado exitosamente","success")):f.a.fire("Error",i.msg,"error"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0),f.a.fire("Error",t.t0.response.msg,"error");case 15:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,n){return t.apply(this,arguments)}}()}(C)),void F())},className:"container",children:[Object(J.jsxs)("div",{className:"form-group",children:[Object(J.jsx)("label",{children:"Fecha y hora inicio"}),Object(J.jsx)(Z.a,{onChange:function(e){c(e),_(Object(i.a)(Object(i.a)({},C),{},{start:e}))},value:r})]}),Object(J.jsxs)("div",{className:"form-group",children:[Object(J.jsx)("label",{children:"Fecha y hora fin"}),Object(J.jsx)(Z.a,{onChange:function(e){j(e),_(Object(i.a)(Object(i.a)({},C),{},{end:e}))},value:d,minDate:r})]}),Object(J.jsx)("hr",{}),Object(J.jsxs)("div",{className:"form-group",children:[Object(J.jsx)("label",{children:"Titulo y notas"}),Object(J.jsx)("input",{type:"text",className:"form-control ".concat(!O&&"is-invalid"),placeholder:"T\xedtulo del evento",name:"title",value:A,autoComplete:"off",onChange:G}),Object(J.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"Una descripci\xf3n corta"})]}),Object(J.jsxs)("div",{className:"form-group",children:[Object(J.jsx)("textarea",{type:"text",className:"form-control",placeholder:"Notas",rows:"5",name:"notes",value:D,onChange:G}),Object(J.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"Informaci\xf3n adicional"})]}),Object(J.jsxs)("button",{type:"submit",className:"btn btn-outline-primary btn-block",children:[Object(J.jsx)("i",{className:"far fa-save"}),Object(J.jsx)("span",{children:" Guardar"})]})]})]})})},re=function(){var e=Object(o.b)();return Object(J.jsx)("div",{children:Object(J.jsx)("button",{className:"btn btn-primary fab",onClick:function(){e(k()),e($())},children:Object(J.jsx)("i",{className:"fas fa-plus"})})})},ce=function(){var e=Object(o.b)();return Object(J.jsx)("div",{children:Object(J.jsxs)("button",{className:"btn btn-danger fab-danger",onClick:function(){e(function(){var e=Object(m.a)(p.a.mark((function e(t,n){var a,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n().calendar.activeEvent,e.prev=1,e.next=4,g("events/".concat(a.id),{},"DELETE");case 4:return r=e.sent,e.next=7,r.json();case 7:c=e.sent,console.log(c),c.ok?(t({type:u.calendarDeletedEvent,payload:a}),t(k()),f.a.fire("Success",c.msg,"success")):f.a.fire("Error",c.msg,"error"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}())},children:[Object(J.jsx)("i",{className:"fas fa-trash mr-2"}),Object(J.jsx)("span",{children:"Borrar evento"})]})})};y.a.locale("es");var oe=Object(X.b)(y.a),se=function(){var e=Object(o.b)();Object(a.useEffect)((function(){e(function(){var e=Object(m.a)(p.a.mark((function e(t){var n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g("events");case 3:return n=e.sent,e.next=6,n.json();case 6:(a=e.sent).ok?((r=a.events).map((function(e){e.start=y()(e.start).toDate(),e.end=y()(e.end).toDate()})),t(N(r))):f.a.fire("Error",a.msg,"error"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0),f.a.fire("Error",e.t0.response.msg,"error");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}())}),[e]);var t=Object(o.c)((function(e){return e.auth})).uid,n=Object(o.c)((function(e){return e.calendar})),r=n.events,c=n.activeEvent,s=Object(a.useState)(localStorage.getItem("lastView")||"month"),i=Object(R.a)(s,2),l=i[0],d=i[1];return Object(J.jsxs)("div",{className:"calendar-screen",children:[Object(J.jsx)(q,{}),Object(J.jsx)(X.a,{localizer:oe,events:r,startAccessor:"start",endAccessor:"end",messages:z,onSelectSlot:function(){e(k())},selectable:!0,eventPropGetter:function(e,n,a,r){return{style:{backgroundColor:t==e.user._id?"blue":"#4EC5F1",borderRadius:"0px",opacity:.8,display:"block"}}},onDoubleClickEvent:function(t){e($())},onSelectEvent:function(t){e(function(e){return{type:u.calendarSetActiveEvent,payload:e}}(t))},onView:function(e){localStorage.setItem("lastView",e),d(e)},view:l,components:{event:K}}),Object(J.jsx)(re,{}),c&&Object(J.jsx)(ce,{}),Object(J.jsx)(ae,{})]})},ie=n(36),ue=["isAuthenticated","component"],le=function(e){var t=e.isAuthenticated,n=e.component,a=Object(ie.a)(e,ue);return Object(J.jsx)(F.b,Object(i.a)(Object(i.a)({},a),{},{component:function(e){return t?Object(J.jsx)(n,Object(i.a)({},e)):Object(J.jsx)(F.a,{to:"/login"})}}))},de=["isAuthenticated","component"],je=function(e){var t=e.isAuthenticated,n=e.component,a=Object(ie.a)(e,de);return Object(J.jsx)(F.b,Object(i.a)(Object(i.a)({},a),{},{component:function(e){return t?Object(J.jsx)(F.a,{to:"/"}):Object(J.jsx)(n,Object(i.a)({},e))}}))},be=function(){var e=Object(o.b)();Object(a.useEffect)((function(){e(function(){var e=Object(m.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("token")){e.next=8;break}return e.next=3,g("auth/renew");case 3:return n=e.sent,e.next=6,n.json();case 6:(a=e.sent).ok?(localStorage.setItem("token",a.token),localStorage.setItem("token-init-date",(new Date).getTime()),t(P({uid:a.uid,name:a.name}))):t(H());case 8:t(H());case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]);var t=Object(o.c)((function(e){return e.auth})),n=t.checking,r=t.uid;return n?Object(J.jsx)("h1",{children:"Espere..."}):Object(J.jsx)(M.a,{children:Object(J.jsx)("div",{children:Object(J.jsxs)(F.d,{children:[Object(J.jsx)(je,{exact:!0,path:"/login",component:B,isAuthenticated:!!r}),Object(J.jsx)(le,{exact:!0,path:"/",component:se,isAuthenticated:!!r}),Object(J.jsx)(F.a,{to:"/"})]})})})},pe=function(){return Object(J.jsx)(o.a,{store:I,children:Object(J.jsx)(be,{})})};n(123);c.a.render(Object(J.jsx)(pe,{}),document.getElementById("root"))},88:function(e,t,n){}},[[125,1,2]]]);
//# sourceMappingURL=main.1f6eea28.chunk.js.map